{% extends 'base.html' %}
{% block title %}  Специалисты {% endblock %}
{% block content %}
    <div class="row">
        <div class="row col-md-8">
        {% if authors_list %}
                {% for person in authors_list %}
                {% if person.photo %}
                    <div class="border-psycho-person row person mx-auto">
                        <div class="col-8 text-center">
                            <img class="img-fluid w-auto imag" src="{{ person.photo.url }}" alt="{{ person.alt }}">
                        </div>

                        <div class="col-4">
                        <div class="my-2 col-5 text-center mb-3">
                            <a href='{% url 'person' pk=person.id %}'><h3><i class="fas fa-user-circle"></i> {{ person.name }}</h3></a>
                        </div>
                        <div>
                            Полное имя: {{ person.full_name }}<br>
                            Контактная информация: {{ person.email }}<br> {{ person.contacts| linebreaks }} <br>
                            {{ person.info }}
                        </div>
                        </div>
                        <div class="offset-4 col-8 text-center mb-5">
                            <b><a class='btn bg-psycho-teal text-psycho-blue' href = '{% url 'person' pk=person.id %}'>Посмотреть</a></b>

                        </div>

                     </div>
                {% endif %}

                {% endfor %}

            {% block pagination %}
                {% include 'pagination.html' %}
            {% endblock %}
        {% else %}
            <h3>Специалисты</h3>
            <p> Специалистов не найдено </p>
        {% endif %}
        </div>
        <div class="col-11 col-md-4 bg-psycho-pearlbush">
                <div class="text-white rounded bg-psycho-teal text-center my-2 py-4">
                    <h3 class="d-none d-xl-inline font-italic">Новые статьи</h3>
                    <h4 class="d-xl-none font-italic">Новые статьи</h4>
                </div>

                {% for article in last_articles %}
                    <div class="card col-12 mb-3 bg-psycho-teal">
                        <div class="card-header bg-psycho-teal border-0 cardhead">
                            <a href="{% url 'article' pk=article.id %}"><h3 class="text-psycho-blue">{{ article.name }}</h3></a>
                        </div>
                        <div class="card-header bg-psycho-teal">
                            <div class="text-psycho-lightblue">
                                <b><a class="link-blue" href="{% url 'person' pk=article.author.id %}"><i
                                        class="fas fa-user"></i> {{ article.author.full_name }}</a></b>
                                <span class="d-xl-none"><br></span>
                                <span class="d-none d-xl-inline">&nbsp;</span>
                                <i class="fas fa-calendar"></i> <i>{{ article.release_date | date:"d E Y" }}</i>
                            </div>
                        </div>
                        <div class="card-body cardbody">
                            {% if article.main_image.photo %}
                                <div>
                                    <div class="text-center my-2 "><img class="img-fluid center"
                                                                        src="{{ article.main_image.photo.url }}"
                                                                        alt="{{ article.main_image.alt }}"></div>
                                    <div>
                                        <p class="text-justify"> {{ article.content | linebreaksbr| safe| truncatechars:'300' }}</p>
                                    </div>
                                </div>
                            {% else %}
                                <div>
                                    <p class="text-justify"> {{ article.content | linebreaksbr| safe| truncatechars:'300' }}</p>
                                </div>
                            {% endif %}
                        </div>
                        <div class="card-footer text-right border-0 bg-psycho-teal">
                            <b><a class='btn bg-psycho-teal text-psycho-blue' href='{% url 'article' pk=article.id %}'>Читать
                                далее...</a></b>
                            <span class="d-none d-xl-inline">&nbsp;<br>&nbsp;</span>
                        </div>
                    </div>
                {% endfor %}
            </div>
    </div>

{% endblock %}
{% block onload %}
        <script>
            function sleep(milliseconds) {
                let start = new Date().getTime();
                for (let i = 0; i < 1e7; i++) {
                    if ((new Date().getTime() - start) > milliseconds) {
                        break;
                    }
                }
            }


            function max_class(lst, l) {

                for (let i = 0; i < lst.length; ++i) {
                    lst[i].style.height = l.toString() + "px";
                }
            }

            window.onload = function () {
                sleep(1000);
                document.getElementById('preloader').classList.add('d-none');
                document.getElementById('body').classList.remove('d-none');
                let width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
                if (width>=1200) {
                    max_class(document.getElementsByClassName("person"), 600);
                    max_class(document.getElementsByClassName("imag"), 400);
                }
                else if (width>=800) {
                    max_class(document.getElementsByClassName("person"), 400);
                }
                else{
                    max_class(document.getElementsByClassName("person"), 200);
                }
            }
        </script>

    {% endblock %}